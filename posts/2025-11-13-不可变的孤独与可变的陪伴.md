# 字符串的独舞：Java中不可变的孤独与可变的陪伴

在 Java 的世界里，每一个对象都有自己的性格。有些温柔可变，任你轻轻触碰，它的世界便随你而动；有些高傲孤独，无论你如何呼唤，它依旧静静守着自己的模样。

`String`，就是那位孤独的舞者；
 `StringBuilder`，则是那位愿意陪你共舞的伴侣。

------

## 1. `String` 的单身特性：孤独优雅的不可变

看看这个例子：

```java
String name = "鸽鸽";
change(name);
System.out.println(name); // 输出 "鸽鸽"
```

方法里：

```java
public static void change(String s) {
    s = "恋爱中的鸽鸽";
}
```

为什么外面的 `name` 没变？
 因为在 Java 里，**方法传递参数总是值传递**。
 即使 `String` 是引用类型，传进去的也是**引用的副本**。
 而 `String` 本身**不可变**，每一次赋值，都是生成了一个新对象。
 它就像一个孤独的舞者，任你如何靠近，它仍在原地旋转，优雅却孤独。💔

------

## 2. `StringBuilder` 的甜蜜传递：可变的陪伴

换成 `StringBuilder`：

```java
StringBuilder sb = new StringBuilder("鸽鸽");
change(sb);
System.out.println(sb); // 输出 "恋爱中的鸽鸽"
```

方法里：

```java
public static void change(StringBuilder sb) {
    sb.setLength(0);
    sb.append("恋爱中的鸽鸽");
}
```

这里为什么外面会跟着变？
 因为 `StringBuilder` **可变**，方法里修改的是同一个对象的内容，引用没换，它的世界自然随你改变。💖

------

## 3. `setLength(0)`：温柔的橡皮擦

`setLength(0)` 是 `StringBuilder` 提供的一个小魔法：

```java
StringBuilder sb = new StringBuilder("鸽鸽最帅！");
sb.setLength(0);
System.out.println(sb); // 输出 ""
```

它不会销毁对象，只是把内部字符清空，像用温柔的手指轻轻抹去纸上的文字。
 下一次 `append()`，新内容就在原地轻轻生长，不会浪费对象，也不会换新的内存。

------

## 4. `String.valueOf`：空指针的小护身符

在代码里，我们常常会遇到可能为 `null` 的值：

```java
StringBuilder startDateBuilder = new StringBuilder(String.valueOf(parse.get("开始时间")));
```

即使 `parse.get("开始时间")` 是 `null`，`String.valueOf()` 也会返回 `"null"` 字符串，而不会抛 `NullPointerException`。

如果想让它更优雅一些，可以写成：

```java
String startTime = (String) parse.get("开始时间");
StringBuilder startDateBuilder = new StringBuilder(startTime == null ? "" : startTime);
```

这样即安全，又不会让空值变成尴尬的 `"null"`。

------

## 5. 方法里重新 `new` 与原地修改的区别

> 小心陷阱：方法里重新 `new StringBuilder()` 并不会改变外面的引用。

```java
public static void handlerAutoTime(StringBuilder startDate, StringBuilder endDate) {
    startDate = new StringBuilder("新的开始时间"); // ❌ 外面不会变
}
```

如果想让外面的对象真正更新，应当 **原地修改内容**：

```java
startDate.setLength(0);
startDate.append("新的开始时间");
```

或者返回新的对象，让调用方去接收。

------

## 6. 爱情传递法则：总结表格

| 类型                         | 可变性   | 方法内修改是否影响外部 |
| ---------------------------- | -------- | ---------------------- |
| String                       | ❌ 不可变 | ❌ 不会变               |
| StringBuilder / StringBuffer | ✅ 可变   | ✅ 会变                 |
| 自定义可变对象               | ✅ 可变   | ✅ 会变（修改内部状态） |

可见：

- **String = 单身狗**，任你怎么传递，自己永远在原地孤独；
- **StringBuilder = 恋爱中的对象**，你改一次，它就跟着你甜蜜地改变；
- 如果想让 `String` 也“传递爱情”，就得返回新对象，或者换成可变对象。

------

## 7. 结语：Java里的柔情与孤傲

在 Java 的长街上，`String` 高傲独行，每一次赋值都像换了新的面纱；
 而 `StringBuilder` 则柔情相随，手心里托着你的每一行文字，轻轻一动，它的世界便随之改变。

所以，下次写方法传参时，记得挑对对象，否则你可能会发现——改了半天，外面的人根本不知道你爱他 😏💌

------

